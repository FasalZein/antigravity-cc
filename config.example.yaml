# CLIProxyAPI Configuration for Antigravity
#
# This config is optimized for using Claude Code with Antigravity models.
# Antigravity provides access to Claude, Gemini, and GPT models via Google OAuth.
#
# Quick Start:
#   1. Install: brew install cliproxyapi
#   2. Login:   cliproxyapi --antigravity-login
#   3. Run:     brew services start cliproxyapi
#   4. Use:     Set ANTHROPIC_BASE_URL=http://127.0.0.1:8317

# =============================================================================
# SERVER SETTINGS
# =============================================================================

# Port for the proxy server
port: 8317

# Bind to localhost only (recommended for security)
host: "127.0.0.1"

# Enable debug logging (set to true for troubleshooting)
debug: false

# Log all requests (useful for debugging)
request-log: false

# Write logs to files in ./logs/ directory
logging-to-file: true

# =============================================================================
# AUTHENTICATION
# =============================================================================

# Directory for storing OAuth tokens
# Tokens are saved as: ~/.cli-proxy-api/antigravity-<email>.json
auth-dir: "~/.cli-proxy-api"

# API keys for client authentication
# Generate your own: openssl rand -hex 24 | sed 's/^/sk-/'
api-keys:
  - "sk-your-api-key-here"

# =============================================================================
# REQUEST HANDLING
# =============================================================================

# Retry failed requests (handles rate limits and temporary errors)
request-retry: 1

# Maximum wait time for rate-limited credentials before retry (seconds)
max-retry-interval: 5

# Emit blank lines every N seconds for non-streaming responses to prevent idle timeouts
nonstream-keepalive-interval: 5

# SSE keep-alive interval to prevent streaming timeouts
streaming:
  keepalive-seconds: 10
  bootstrap-retries: 2

# Automatically switch when quota exceeded
quota-exceeded:
  switch-project: true        # Try another account
  switch-preview-model: false # Don't try preview model variant

# =============================================================================
# MODEL ALIASES
# =============================================================================
# Expose upstream Antigravity model names under friendly aliases.
# fork: true keeps both the original name AND the alias available.

oauth-model-alias:
  antigravity:
    - name: gemini-3-pro-high
      alias: gemini-3-pro-preview
    - name: gemini-3-flash
      alias: gemini-3-flash-preview
    - name: claude-sonnet-4-6
      alias: gemini-claude-sonnet-4-5
      fork: true
    - name: claude-opus-4-6-thinking
      alias: gemini-claude-opus-4-5-thinking
      fork: true

# =============================================================================
# MODEL MAPPINGS (Optional)
# =============================================================================
# Map Claude Code's internal model names to Antigravity equivalents.
# Uncomment and enable if you want automatic model translation.

# ampcode:
#   force-model-mappings: true
#   model-mappings:
#     # Claude Opus -> Antigravity Claude Opus (thinking)
#     - from: claude-opus-4-6-20260101
#       to: claude-opus-4-6-thinking
#     - from: claude-opus-4-6
#       to: claude-opus-4-6-thinking
#
#     # Claude Sonnet -> Antigravity Claude Sonnet 4.6
#     - from: claude-sonnet-4-6-20260101
#       to: claude-sonnet-4-6
#     - from: claude-sonnet-4-5-20250929
#       to: claude-sonnet-4-6
#     - from: claude-sonnet-4-5
#       to: claude-sonnet-4-6
#
#     # Claude Haiku -> Gemini Flash (fast/cheap substitute)
#     - from: claude-haiku-4-5-20251001
#       to: gemini-3-flash-preview
#     - from: claude-3-5-haiku-20241022
#       to: gemini-3-flash-preview

# =============================================================================
# REMOTE MANAGEMENT (Optional)
# =============================================================================
# Web-based control panel for managing the proxy remotely.
# Disabled by default for security.

remote-management:
  allow-remote: false
  secret-key: ""
  disable-control-panel: true

# =============================================================================
# USAGE STATISTICS (Optional)
# =============================================================================
# Track token usage across accounts.

usage-statistics-enabled: true

# =============================================================================
# AVAILABLE ANTIGRAVITY MODELS
# =============================================================================
# Use these model names with Claude Code:
#
# Claude Models (recommended):
#   - claude-opus-4-6-thinking           # Best quality, extended thinking
#   - claude-sonnet-4-6                  # Fast, latest Sonnet
#
# Legacy aliases (route to the models above):
#   - gemini-claude-opus-4-5-thinking    # -> claude-opus-4-6-thinking
#   - gemini-claude-sonnet-4-5           # -> claude-sonnet-4-6
#
# Gemini Models:
#   - gemini-3-pro-preview               # Gemini 3 Pro (1M context)
#   - gemini-2.5-flash                   # Gemini 2.5 Flash
#   - gemini-2.5-flash-lite              # Fastest, lightest
#
# GPT Models:
#   - gpt-oss-120b-medium                # GPT-OSS 120B
#
# =============================================================================
# ENVIRONMENT VARIABLES FOR CLAUDE CODE
# =============================================================================
# Add these to your ~/.zshrc or ~/.bashrc:
#
#   export ANTHROPIC_BASE_URL="http://127.0.0.1:8317"
#   export ANTHROPIC_API_KEY="sk-your-api-key-here"
#   export ANTHROPIC_DEFAULT_OPUS_MODEL="claude-opus-4-6-thinking"
#   export ANTHROPIC_DEFAULT_SONNET_MODEL="claude-sonnet-4-6"
#   export ANTHROPIC_DEFAULT_HAIKU_MODEL="gemini-3-flash-preview"
#
# =============================================================================
